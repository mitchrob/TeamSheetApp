{% extends 'base.html' %}
{% block title %}Potential Duplicates{% endblock %}
{% block content %}

  <h1>Potential Duplicate Players</h1>
  <p>
    The following groups of players have very similar names and may be duplicates.
    Review each group and use the "Review & Merge" button to consolidate them into a single correct record.
  </p>

  {% if detailed_groups %}
    {% for group in detailed_groups %}
      <div class="duplicate-group">
        <h2>Group: {{ group|map(attribute='name')|join(', ') }}</h2>
        <div class="player-columns">
          <ul class="list-group">
            {% for player_stats in group %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="{{ url_for('player_view', name=player_stats.name) }}">{{ player_stats.name }}</a>
                <span class="badge bg-primary rounded-pill">{{ player_stats.total }} appearances</span>
              </li>
            {% endfor %}
          </ul>
        </div>
        <div class="mt-3">
          <a href="{{ url_for('merge_form', players=group|map(attribute='name')|join(',')) }}" class="btn btn-primary">Review & Merge</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>No potential duplicates found with the current similarity threshold.</p>
  {% endif %}
{% endblock %}